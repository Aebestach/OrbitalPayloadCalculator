# Orbital Payload Calculator 中的估计值与可计算值

本文档说明计算器中哪些数据是**根据物理公式精确计算**（随天体不同自动调整），哪些是**估计值**（使用启发式或经验公式）。

---

## 实际可计算的量（根据天体自动调整）

以下量由天体物理属性和轨道几何精确推导，不依赖估计：

| 数据 | 计算方式 | 使用的天体属性 |
|------|----------|----------------|
| **地表理想 Δv** | 两模型按 α = a/r₀、e = (rAp−rPe)/(rAp+rPe) 自动选择。**模型 A**（α < 1.5 或 α ≤ 2 且 e < 0.1）：`√(2μ × (1/r₀ − 1/(rPe+rAp)))`。**模型 B**（其余）：霍曼 burn1+burn2，椭圆轨道 +burn3 | `gravParameter`、`Radius`、rPe、rAp |
| **轨道速度** | `v = √(μ × (2/rPe − 1/a))` | `gravParameter`、`Radius`、轨道高度 |
| **平面变轨 ΔV** | `2v × sin(θ/2)` | 轨道速度、发射纬度、目标倾角 |
| **自转增益/损失** | 赤道速度 + 纬度修正 | `rotationPeriod`、`Radius` |
| **阶段 ΔV** | 齐奥尔科夫斯基公式 | 质量、推进剂、Isp |
| **大气 Isp 混合** | 采样 `GetPressure(h)` 曲线速度加权 | `atmosphereDepth`、`atmospherePressureSeaLevel` |
| **仿真中重力损失** | 时间步进 `g = μ/R²` | `gravParameter`、`Radius` |
| **仿真中大气密度** | `ρ = p/(R_air × T)` | `GetPressure(h)`、`GetTemperature(h)` |
| **默认轨道高度** | 大气顶 + 10000 m | `atmosphereDepth` |
| **分离组（助推器干质量）** | 扫描 `maxPropStageNum-1` 至 0 所有阶段的分离器；发动机燃尽时抛离 | 部件层级、`inverseStage`、`ModuleDecouple` |

### 地表理想 Δv 模型详情

两体、冲量式；忽略大气与重力损失。符号：μ = gravParameter，r₀ = 天体半径，rPe/rAp = 近点/远点半径，a = (rPe+rAp)/2，**α = a/r₀**，**e = (rAp−rPe)/(rAp+rPe)**。

**模型选择（α, e）：**

- **α < 1.5** → 模型 A（能量最优下界）
- **1.5 ≤ α ≤ 2.0**：若 e < 0.1 → 模型 A；若 e ≥ 0.1 → 模型 B
- **α > 2.0** → 模型 B（霍曼结构）

**模型 A：** 全局最小 Δv。椭圆：`√(2μ × (1/r₀ − 1/(rPe+rAp)))`。圆轨道：rPe=rAp=r 时同上。

**模型 B：** 分段点火。圆轨道 (rPe=rAp=r)：burn1 = √(μ/r₀)·√(2r/(r₀+r))，burn2 = √(μ/r)·(1−√(2r₀/(r₀+r)))。椭圆：在 rPe 处 burn1+burn2，远点处 burn3。两模型当 r→∞ 时收敛为 √(2μ/r₀)（逃逸速度）。

完整推导与公式见 [IDEAL_DV_MODELS_CN.md](IDEAL_DV_MODELS_CN.md)。

---

## 估计值（启发式 / 经验公式）

以下量因无法在编辑器中获取精确数据或计算代价高，而使用启发式或经验公式：

| 数据 | 估计方式 | 说明 |
|------|----------|------|
| **CdA（气动阻力面积）** | 编辑器和飞行模式一致：`Cd × √(湿质量)`，用户输入 Cd (0.3–2.0) 或默认 0.7/1.0 | Cd 系数 × √质量 启发式 |
| **重力损失**（无仿真时） | `FallbackEstimate` 经验公式 | 无推力/Isp 数据时使用的替代公式 |
| **大气损失**（无仿真时） | `atmoA + atmoB` 经验公式 | 基于 gN、pN、dN 归一化缩放因子的拟合公式 |
| **姿态损失** | `baseA + baseB × incFactor` | 无论仿真与否都使用经验系数；典型参考见下表 |
| **Turn Start Speed** | `80 × gN^0.25 × (...)` | 基于重力、大气归一化得出的启转速度 |
| **Turn Start Altitude** | `atmoHeight × (0.01 + 0.004×ln(1+pN))` | 启转高度估计 |
| **大气 Isp 混合权重** | `1 - 0.5×i/N` | 对"火箭在各高度停留时间"的近似权重 |
| **转弯指数（重力转弯）** | 乐观模式：0.50；普通模式：0.58（底级模拟）或 0.70（损失模型） | 经验值；控制俯仰转向速率 |

### 姿态损失典型参考

| 情况 | 典型姿态损失 |
|------|--------------|
| 优秀轨迹 | 10–30 m/s |
| 一般轨迹 | 30–80 m/s |
| 粗暴转弯 | 100–300 m/s |

---

## 参数优先级

- **高级设置** 中的重力/大气/姿态损失覆盖、转弯速度、Cd 系数、重力转弯高度 **优先级始终高于** 普通估算/乐观估算按钮的默认值。

---

## 简要总结

- **可算的量**：地表理想 Δv（模型 A/B）、轨道速度、平面变轨、自转、阶段 ΔV、重力场、大气压强/温度/密度、大气混合 Isp。这些都由天体数据驱动，随天体不同自动变化。
- **估计的量**：Cd 系数与 CdA、重力/大气/姿态损失（尤其是 Fallback 和姿态项）、启转速度和高度、大气混合权重。这些依赖启发式或经验规则。

- **编辑器和飞行模式**：CdA 使用相同启发式，不基于部件几何计算。
